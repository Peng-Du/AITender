# CLAUDE.md

This file provides guidance to Claude Code (claude.ai/code) when working with code in this repository.

## Project Overview

AutoTenderReader is a Python-based automated tender document processing system that:
- Downloads PDF tender documents daily
- Converts PDFs to Markdown using OCR fallback
- Processes documents through n8n workflows for AI analysis
- Generates HTML summary reports and JSON data

## Key Commands

### Running the Main System
```bash
python daily_tasks.py
```

### Individual Processing Steps
```bash
# Process PDFs to Markdown for specific date
python daily_tasks.py --process-pdfs --date 2025-01-15

# Run JSON parser for specific date and language
python simple_json_parser.py --date 2025-01-15 --language English
python simple_json_parser.py --date 2025-01-15 --language Chinese

# Convert single PDF to Markdown
python pdf2md.py input.pdf output.md

# Clear download folder and download new documents
python run_clear_and_download.py

# Check for duplicate files
python check_duplicates.py
```

### n8n Workflow
Start the n8n workflow processor:
```bash
npx n8n
```

## System Architecture

### Directory Structure
- `../TenderBase/` - Contains download directories and processed data organized by date
- `../TenderBase/Download{YYYY-MM-DD}/` - Raw PDF downloads
- `../TenderBase/{YYYY-MM-DD}/` - Processed Markdown files
- `../TenderBase/summary/` - HTML summary reports
- `../TenderBase/parsed_data/` - JSON parsed data files

### Core Components

#### daily_tasks.py
- Orchestrates the entire daily processing workflow
- Scheduled tasks: 01:00 (download), 01:30 (PDF processing), 04:00 (JSON parsing)
- Integrates with TenderBase main.py for downloads
- Supports date-specific processing with `--date` parameter

#### pdf2md.py
- Converts PDF to Markdown using pdfplumber for direct text extraction
- Falls back to OCR using Tesseract when text extraction is insufficient
- Requires Tesseract OCR and Poppler dependencies
- Uses Spanish language settings for OCR by default

#### simple_json_parser.py
- Merges multiple summary JSON files generated by n8n workflows
- Handles JSON parsing with robust error recovery and quote escaping
- Generates HTML reports with language support (Chinese/English)
- Creates both JSON data files and formatted HTML summaries

#### n8n Integration
- Uses system prompts in `n8n_summary_system_prompt_EN.txt` and `n8n_summary_system_prompt_ZH.txt`
- Processes Markdown files through AI analysis workflows
- Generates individual summary JSON files that are later merged

## Dependencies
- Python packages: `schedule`, `pdfplumber`, `pdf2image`, `pytesseract`, `argparse`
- External tools: Tesseract OCR, Poppler, n8n
- File paths use Windows format (D:\...) but are structured with relative paths

## Important Notes
- System processes documents on a daily schedule with specific timing
- Language selection affects both n8n system prompts and JSON parser output
- Error handling includes retry mechanisms for JSON parsing failures
- File organization follows strict date-based directory structure
- The system requires both Python scripts and n8n workflows to run simultaneously